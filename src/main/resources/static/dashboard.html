<!DOCTYPE html>
<html lang="zh-TW" xmlns:x-on="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>冰寶 - 您的冰箱智慧助手</title>
	<meta property="og:title" content="冰寶 - 您的冰箱智慧助手">
	<meta property="og:description" content="「冰寶」是一款智慧冰箱管理助手，專為食品管理而設計。幫助您輕鬆追蹤冰箱內的食材，提供有效的存放建議，並提醒您即將過期的食品。利用AI掃描技術，讓您的食材快速建檔，放進冰箱。冰寶都是提升食品管理的理想夥伴。">
	<meta property="og:image" content="images/favicon.ico">
	<meta property="og:url" content="https://www.gurula.cc/bingBao/dashboard.html">
	<meta property="og:type" content="website">
	<meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
	<link rel="icon" href="images/favicon.ico" type="image/x-icon"/>

	<!-- Fonts and icons -->
	<script src="js/webfont.min.js"></script>
	<script>
		WebFont.load({
			google: {"families":["Public Sans:300,400,500,600,700"]},
			custom: {"families":["Font Awesome 5 Solid", "Font Awesome 5 Regular", "Font Awesome 5 Brands", "simple-line-icons"], urls: ['css/fonts.min.css']},
			active: function() {
				sessionStorage.fonts = true;
			}
		});
	</script>
	<script src="js/deviceType.js"></script>

	<!-- CSS Files -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/plugins.min.css">
	<link rel="stylesheet" href="css/kaiadmin.min.css">

	<!-- CSS Just for demo purpose, don't include it in your project -->
<!--	<link rel="stylesheet" href="css/demo.css">-->
</head>
<body x-data="loadData()" x-init="init()">
	<div class="wrapper">
		<!-- Sidebar -->
		<div class="sidebar" data-background-color="dark">
			<div class="sidebar-logo">
				<!-- Logo Header -->
				<div class="logo-header" data-background-color="dark">

					<a href="dashboard.html" class="logo">
						<img src="images/fridge001.jpg" alt="navbar brand" class="navbar-brand" height="20">
					</a>
					<div class="nav-toggle">
						<button class="btn btn-toggle toggle-sidebar">
							<i class="gg-menu-right"></i>
						</button>
						<button class="btn btn-toggle sidenav-toggler">
							<i class="gg-menu-left"></i>
						</button>
					</div>
					<button class="topbar-toggler more">
						<i class="gg-more-vertical-alt"></i>
					</button>
				</div>
				<!-- End Logo Header -->
			</div>
			<div class="sidebar-wrapper scrollbar scrollbar-inner">
				<div class="sidebar-content">
					<ul class="nav nav-secondary">
						<li class="nav-section">
							<span class="sidebar-mini-icon">
								<i class="fa fa-ellipsis-h"></i>
							</span>
							<h4 class="text-section">清單</h4>
						</li>
						<li class="nav-item">
							<a href="dashboard.html">
								<i class="fas fa-desktop"></i>
								<p>冰箱清單</p>
								<span class="badge badge-success" x-text="todayListLabel"></span>
							</a>
						</li>
						<li class="nav-item">
							<a href="product.html">
							  <i class="fas fa-fish"></i>
							  <p>食材模板</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="shopping-list.html">
								<i class="fas fa-shopping-basket"></i>
								<p>回購清單</p>
							</a>
						</li>
						<li class="nav-section">
							<span class="sidebar-mini-icon">
								<i class="fa fa-ellipsis-h"></i>
							</span>
							<h4 class="text-section">動作</h4>
						</li>
						<li class="nav-item submenu">
							<a data-bs-toggle="collapse" href="#submenu" class="" aria-expanded="true">
								<i class="fas fa-bars"></i>
								<p>食材建檔</p>
								<span class="caret"></span>
							</a>
							<div class="collapse show" id="submenu" style="">
								<ul class="nav nav-collapse">
									<li class="submenu">
										<a href="import.html">
											<span class="sub-item">AI建檔</span>
										</a>
										<a href="add.html">
											<span class="sub-item">手動輸入</span>
										</a>
									</li>
								</ul>
							</div>
						</li>
						<li class="nav-item">
							<a href="receive.html">
								<i class="fas fa-box-open"></i>
								<p>食材放進冰箱</p>
							</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!-- End Sidebar -->

		<div class="main-panel">
			<div class="main-header">
				<div class="main-header-logo">
					<!-- Logo Header -->
					<div class="logo-header" data-background-color="dark">

						<a href="dashboard.html" class="logo">
							<img src="images/fridge001.jpg" alt="navbar brand" class="navbar-brand" height="20">
						</a>
						<div class="nav-toggle">
							<button class="btn btn-toggle toggle-sidebar">
								<i class="gg-menu-right"></i>
							</button>
							<button class="btn btn-toggle sidenav-toggler">
								<i class="gg-menu-left"></i>
							</button>
						</div>
						<button class="topbar-toggler more">
							<i class="gg-more-vertical-alt"></i>
						</button>

					</div>
					<!-- End Logo Header -->
				</div>
				<!-- Navbar Header -->
				<nav hidden="hidden" class="navbar navbar-header navbar-header-transparent navbar-expand-lg border-bottom"></nav>
				<!-- End Navbar -->
			</div>

			<div class="container">
				<div class="page-inner">
					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="card-header d-flex justify-content-between align-items-center">
									<h4 class="card-title">冰箱清單</h4>
								</div>
								<div class="card-body">
									<ul class="nav nav-pills nav-secondary nav-pills-no-bd" id="pills-tab-without-border" role="tablist">
										<li class="nav-item" role="presentation">
											<a class="nav-link active" id="pills-today-tab-nobd" data-bs-toggle="pill" href="#pills-today-nobd" role="tab" aria-controls="pills-today-nobd" aria-selected="true"><i class="fas fa-laugh-beam me-2"></i>今日放進冰箱</a>
										</li>
										<li class="nav-item" role="presentation">
											<a class="nav-link" id="pills-soon-tab-nobd" data-bs-toggle="pill" href="#pills-soon-nobd" role="tab" aria-controls="pills-soon-nobd" aria-selected="false" tabindex="-1"><i class="fas fa-cookie-bite me-2"></i>快過期</a>
										</li>
										<li class="nav-item" role="presentation">
											<a class="nav-link" id="pills-valid-tab-nobd" data-bs-toggle="pill" href="#pills-valid-nobd" role="tab" aria-controls="pills-valid-nobd" aria-selected="false" tabindex="-1"><i class="fas fa-cookie me-2"></i>在有效期限內</a>
										</li>
									</ul>
									<div class="tab-content mt-2 mb-3" id="pills-without-border-tabContent">
<!--										今日放進冰箱的-->
										<div class="tab-pane active" id="pills-today-nobd" role="tabpanel" aria-labelledby="pills-today-tab-nobd">
											<div class="col-md-12">
<!--												<div class="card">-->
												<div class="card-header">
													<div class="d-flex align-items-center">
														<h4 class="card-title"></h4>
													</div>
												</div>
												<div class="card-body">
													<div class="table-responsive">
														<div id="add-row_wrapper_1" class="dataTables_wrapper container-fluid dt-bootstrap4">
															<div class="row">
																<div class="col-sm-12 col-md-6">
																	<div id="select-product_filter_today" class="mb-3">
																		<input x-on:keydown.enter="todayProductSearch()" id="todayProductKeyword" type="search" class="form-control" placeholder="可搜尋食材名稱" aria-controls="add-row">
																	</div>
																	<div class="d-flex flex-column flex-md-row align-items-start mb-3">
																		<select class="form-select form-control me-2 mb-2 mb-md-0" x-model="todaySelectedCategory" x-on:change="todayCategoryChange()">
																			<option value="">請選擇主分類</option>
																			<option value="MEAT">肉品</option>
																			<option value="SEAFOOD">海鮮</option>
																			<option value="VEGETABLES">青菜</option>
																			<option value="FRUITS">水果</option>
																			<option value="GRAINS">穀物</option>
																			<option value="BEVERAGES">飲料</option>
																			<option value="CONDIMENTS">醬料</option>
																			<option value="SNACKS">零食</option>
																			<option value="BAKERY">烘焙食品</option>
																			<option value="MEDICINE">藥品</option>
																			<option value="CANNED_FOOD">罐頭食品</option>
																			<option value="SPICES">香料</option>
																			<option value="OILS">食用油</option>
																			<option value="SWEETS">甜品</option>
																			<option value="DRIED_FOOD">乾貨</option>
																			<option value="HEALTH_FOOD">保健食品</option>
																		</select>
																		<template x-if="todaySelectedCategory !== 'MEAT' && todaySelectedCategory !== 'SEAFOOD'">
																			<select class="form-select form-control" x-model="todaySelectedSubCategory" disabled x-on:change="todayProductSearch()">
																				<option value="">-</option>
																			</select>
																		</template>
																		<template x-if="todaySelectedCategory === 'MEAT'">
																			<select class="form-select form-control" x-model="todaySelectedSubCategory" x-on:change="todayProductSearch()">
																				<option value="">請選擇副分類</option>
																				<option value="BEEF">牛肉</option>
																				<option value="PORK">豬肉</option>
																				<option value="CHICKEN">雞肉</option>
																				<option value="EGG">雞蛋</option>
																			</select>
																		</template>
																		<template x-if="todaySelectedCategory === 'SEAFOOD'">
																			<select class="form-select form-control" x-model="todaySelectedSubCategory" x-on:change="todayProductSearch()">
																				<option value="">請選擇副分類</option>
																				<option value="FISH">魚</option>
																				<option value="SHRIMP">蝦</option>
																			</select>
																		</template>
																	</div>
																	<div class="d-flex flex-column flex-md-row align-items-start">
																		<select class="form-select form-control" x-model="todayStorePlace" x-on:change="todayProductSearch()">
																			<option value="">請選擇存放位置</option>
																			<option value="HUALIEN_ALL">花蓮全部</option>
																			<option value="HUALIEN_REF_2F_LEFT">花蓮2樓左側冰箱</option>
																			<option value="HUALIEN_REF_2F_RIGHT">花蓮2樓右側冰箱</option>
																			<option value="HUALIEN_REF_1F_RIGHT">花蓮1樓冰箱</option>
																			<option value="HUALIEN_OTHER">花蓮其他</option>
																			<option value="TAIPEI_REF">台北冰箱</option>
																			<option value="TAIPEI_OTHER">台北其他</option>
																		</select>
																	</div>
																</div>
																<div class="col-sm-12 col-md-6 d-flex flex-column align-items-end mt-md-0 mt-2">
																	<div class="mb-3">
																		<button type="button" class="btn btn-primary" x-on:click="exportExcel('today')">
																			<i class="fas fa-file-excel me-2"></i>
																			匯出Excel
																		</button>
																	</div>

																	<div class="d-flex flex-column align-items-end">
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-edit fs-5"></i>
																			<span class="ms-2 text-muted">：登錄使用數量</span>
																		</div>
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-map-marker fs-5"></i>
																			<span class="ms-2 text-muted">：變更存放位置</span>
																		</div>
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-list fs-5"></i>
																			<span class="ms-2 text-muted">：查看食材細節</span>
																		</div>
																		<div class="d-flex align-items-center">
																			<i class="fas fa-trash-alt fs-5"></i>
																			<span class="ms-2 text-muted">：丟棄庫存食材</span>
																		</div>
																	</div>
																</div>
															</div>
															<div class="row">
																<div class="col-sm-12">
																	<table id="add-row_1" class="display table table-striped table-hover dataTable" role="grid" aria-describedby="add-row_info">
																		<thead>
																		<tr role="row">
																			<th>食材照片</th>
																			<th>食材名稱</th>
																			<th>剩餘數量</th>
																			<th>有效期限</th>
																			<th>何時通知快過期</th>
																			<th>動作</th>
																		</tr>
																		</thead>
																		<tbody>
																		<template x-for="(item,index) in getTodayData()" :key="index">
																			<tr role="row" class="odd">
																				<td>
																					<img :src="item.coverPath" style="width: 100px; height: 100px; border-radius: 10%;">
																				</td>
																				<td x-text="item.name"></td>
																				<td x-text="item.totalAmount"></td>
																				<td x-text="item.expiryDate"></td>
																				<td x-text="item.noticeDate"></td>
																				<td>
																					<button @click="openAmountModal(item.receiveItemId, item.totalAmount)" type="button" data-bs-toggle="tooltip" title="登錄使用數量" class="btn btn-link btn-primary">
																						<i class="fas fa-edit fs-4"></i>
																					</button>
																					<button @click="openPlaceModal(item.receiveItemId, item.storePlaceLabel)" type="button" data-bs-toggle="tooltip" title="變更存放位置" class="btn btn-link btn-primary">
																						<i class="fas fa-map-marker fs-4"></i>
																					</button>
																					<button @click="openDetailModal(item.id)" type="button" data-bs-toggle="tooltip" title="查看庫存食材細節" class="btn btn-link btn-info">
																						<i class="fas fa-list fs-4"></i>
																					</button>
																					<button @click="openDeleteModal(item.receiveItemId)" type="button" data-bs-toggle="tooltip" title="丟棄" class="btn btn-link btn-danger">
																						<i class="fas fa-trash-alt fs-4"></i>
																					</button>
																				</td>
																			</tr>
																		</template>
																		</tbody>
																	</table>
																	<nav class="mt-5 mb-4" x-show="pageCount_today() > 1">
																		<ul class="pagination justify-content-center card-page">
																			<li class="page-item" :class="{ 'disabled' : pageNumber_today==0 }">
																				<a
																						class="page-link page-prev"
																						type="button"
																						x-on:click="prevPage_today();"
																						:disabled="pageNumber_today==0"
																				>
																					<i class="fa fas fa-chevron-left"></i>
																				</a>
																			</li>
																			<li
																					class="page-item disabled"
																					:class="{ 'd-none' : pageCount_today() <= 4 || pageNumber_today == 0 || ( pageCount_today() > 4 && pageNumber_today == pageCount_today() ) }"
																			>
																				<a class="page-link">···</a>
																			</li>
																			<template x-for="(page,index) in pages_today()" :key="index">
																				<li
																						class="page-item"
																						:class="{ 'active' : index === pageNumber_today , 'd-none' : pageCount_today() > 4 && ( (index < pageNumber_today && pageNumber_today < pageCount_today() -4) || (index < pageCount_today() -4 && pageNumber_today >= pageCount_today() -4) || index >= pageNumber_today+4 ) }"
																				>
																					<a
																							class="page-link"
																							type="button"
																							x-on:click="viewPage_today(index);"
																							x-text="index+1"
																					></a>
																				</li>
																			</template>
																			<li
																					class="page-item disabled"
																					:class="{ 'd-none' : pageCount_today() <= 4 || pageNumber_today >= pageCount_today() -4}"
																			>
																				<a class="page-link">···</a>
																			</li>
																			<li
																					class="page-item"
																					:class="{ 'disabled' : pageNumber_today >= pageCount_today() -1 }"
																			>
																				<a
																						class="page-link page-next"
																						type="button"
																						x-on:click="nextPage_today();"
																						:disabled="pageNumber_today >= pageCount_today() -1"
																				>
																					<i class="fa fas fa-chevron-right"></i>
																				</a>
																			</li>
																		</ul>
																	</nav>
																</div>
															</div>
														</div>
													</div>
												</div>
<!--												</div>-->
											</div>

										</div>
<!--										快過期-->
										<div class="tab-pane fade" id="pills-soon-nobd" role="tabpanel" aria-labelledby="pills-today-tab-nobd">
											<div class="col-md-12">
<!--												<div class="card">-->
												<div class="card-header">
													<div class="d-flex align-items-center">
														<h4 class="card-title"></h4>
													</div>
												</div>
												<div class="card-body">
													<div class="table-responsive">
														<div id="add-row_wrapper_2" class="dataTables_wrapper container-fluid dt-bootstrap4">
															<div class="row">
																<div class="col-sm-12 col-md-6">
																	<div id="select-product_filter_soon" class="mb-3">
																		<input x-on:keydown.enter="soonProductSearch()" id="soonProductKeyword" type="search" class="form-control" placeholder="可搜尋食材名稱" aria-controls="add-row">
																	</div>
																	<div class="d-flex flex-column flex-md-row align-items-start mb-3">
																		<select class="form-select form-control me-2 mb-2 mb-md-0" x-model="soonSelectedCategory" x-on:change="soonCategoryChange()">
																			<option value="">請選擇主分類</option>
																			<option value="MEAT">肉品</option>
																			<option value="SEAFOOD">海鮮</option>
																			<option value="VEGETABLES">青菜</option>
																			<option value="FRUITS">水果</option>
																			<option value="GRAINS">穀物</option>
																			<option value="BEVERAGES">飲料</option>
																			<option value="CONDIMENTS">醬料</option>
																			<option value="SNACKS">零食</option>
																			<option value="BAKERY">烘焙食品</option>
																			<option value="MEDICINE">藥品</option>
																			<option value="CANNED_FOOD">罐頭食品</option>
																			<option value="SPICES">香料</option>
																			<option value="OILS">食用油</option>
																			<option value="SWEETS">甜品</option>
																			<option value="DRIED_FOOD">乾貨</option>
																			<option value="HEALTH_FOOD">保健食品</option>
																		</select>
																		<template x-if="soonSelectedCategory !== 'MEAT' && soonSelectedCategory !== 'SEAFOOD'">
																			<select class="form-select form-control" x-model="soonSelectedSubCategory" disabled x-on:change="soonProductSearch()">
																				<option value="">-</option>
																			</select>
																		</template>
																		<template x-if="soonSelectedCategory === 'MEAT'">
																			<select class="form-select form-control" x-model="soonSelectedSubCategory" x-on:change="soonProductSearch()">
																				<option value="">請選擇副分類</option>
																				<option value="BEEF">牛肉</option>
																				<option value="PORK">豬肉</option>
																				<option value="CHICKEN">雞肉</option>
																				<option value="EGG">雞蛋</option>
																			</select>
																		</template>
																		<template x-if="soonSelectedCategory === 'SEAFOOD'">
																			<select class="form-select form-control" x-model="soonSelectedSubCategory" x-on:change="soonProductSearch()">
																				<option value="">請選擇副分類</option>
																				<option value="FISH">魚</option>
																				<option value="SHRIMP">蝦</option>
																			</select>
																		</template>
																	</div>
																	<div class="d-flex flex-column flex-md-row align-items-start">
																		<select class="form-select form-control" x-model="soonStorePlace" x-on:change="soonProductSearch()">
																			<option value="">請選擇存放位置</option>
																			<option value="HUALIEN_ALL">花蓮全部</option>
																			<option value="HUALIEN_REF_2F_LEFT">花蓮2樓左側冰箱</option>
																			<option value="HUALIEN_REF_2F_RIGHT">花蓮2樓右側冰箱</option>
																			<option value="HUALIEN_REF_1F_RIGHT">花蓮1樓冰箱</option>
																			<option value="HUALIEN_OTHER">花蓮其他</option>
																			<option value="TAIPEI_REF">台北冰箱</option>
																			<option value="TAIPEI_OTHER">台北其他</option>
																		</select>
																	</div>
																</div>
																<div class="col-sm-12 col-md-6 d-flex flex-column align-items-end mt-md-0 mt-2">
																	<div class="mb-3">
																		<button type="button" class="btn btn-primary" x-on:click="exportExcel('soon')">
																			<i class="fas fa-file-excel me-2"></i>
																			匯出Excel
																		</button>
																	</div>

																	<div class="d-flex flex-column align-items-end">
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-edit fs-5"></i>
																			<span class="ms-2 text-muted">：登錄使用數量</span>
																		</div>
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-map-marker fs-5"></i>
																			<span class="ms-2 text-muted">：變更存放位置</span>
																		</div>
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-list fs-5"></i>
																			<span class="ms-2 text-muted">：查看食材細節</span>
																		</div>
																		<div class="d-flex align-items-center">
																			<i class="fas fa-trash-alt fs-5"></i>
																			<span class="ms-2 text-muted">：丟棄庫存食材</span>
																		</div>
																	</div>
																</div>
															</div>
															<div class="row">
																<div class="col-sm-12">
																	<table id="add-row_2" class="display table table-striped table-hover dataTable" role="grid" aria-describedby="add-row_info">
																		<thead>
																		<tr role="row">
																			<th>食材照片</th>
																			<th>食材名稱</th>
																			<th>剩餘數量</th>
																			<th>有效期限</th>
																			<th>再過多久過期</th>
																			<th>已存放多久</th>
																			<th>動作</th>
																		</tr>
																		</thead>
																		<tbody>
																		<template x-for="(item,index) in getExpiringSoonData()" :key="index">
																			<tr role="row" class="odd">
																				<td>
																					<img :src="item.coverPath" style="width: 100px; height: 100px; border-radius: 10%;">
																				</td>
																				<td x-text="item.name"></td>
																				<td x-text="item.totalAmount"></td>
																				<td x-text="item.expiryDate"></td>
																				<td x-text="item.expiryTime === '0天' ? '今天到期' : item.expiryTime"></td>
																				<td x-text="item.existedTime === '0天' ? '今天放進冰箱' : item.existedTime"></td>
																				<td>
																					<button @click="openAmountModal(item.receiveItemId, item.totalAmount)" type="button" data-bs-toggle="tooltip" title="登錄使用數量" class="btn btn-link btn-primary">
																						<i class="fas fa-edit fs-4"></i>
																					</button>
																					<button @click="openPlaceModal(item.receiveItemId, item.storePlaceLabel)" type="button" data-bs-toggle="tooltip" title="變更存放位置" class="btn btn-link btn-primary">
																						<i class="fas fa-map-marker fs-4"></i>
																					</button>
																					<button @click="openDetailModal(item.id)" type="button" data-bs-toggle="tooltip" title="查看庫存食材細節" class="btn btn-link btn-info">
																						<i class="fas fa-list fs-4"></i>
																					</button>
																					<button @click="openDeleteModal(item.receiveItemId)" type="button" data-bs-toggle="tooltip" title="丟棄" class="btn btn-link btn-danger">
																						<i class="fas fa-trash-alt fs-4"></i>
																					</button>
																				</td>
																			</tr>
																		</template>
																		</tbody>
																	</table>
																	<nav class="mt-5 mb-4" x-show="pageCount_soon() > 1">
																		<ul class="pagination justify-content-center card-page">
																			<li class="page-item" :class="{ 'disabled' : pageNumber_soon==0 }">
																				<a
																						class="page-link page-prev"
																						type="button"
																						x-on:click="prevPage_soon();"
																						:disabled="pageNumber_soon==0"
																				>
																					<i class="fa fas fa-chevron-left"></i>
																				</a>
																			</li>
																			<li
																					class="page-item disabled"
																					:class="{ 'd-none' : pageCount_soon() <= 4 || pageNumber_soon == 0 || ( pageCount_soon() > 4 && pageNumber_soon == pageCount_soon() ) }"
																			>
																				<a class="page-link">···</a>
																			</li>
																			<template x-for="(page,index) in pages_soon()" :key="index">
																				<li
																						class="page-item"
																						:class="{ 'active' : index === pageNumber_soon , 'd-none' : pageCount_soon() > 4 && ( (index < pageNumber_soon && pageNumber_soon < pageCount_soon() -4) || (index < pageCount_soon() -4 && pageNumber_soon >= pageCount_soon() -4) || index >= pageNumber_soon+4 ) }"
																				>
																					<a
																							class="page-link"
																							type="button"
																							x-on:click="viewPage_soon(index);"
																							x-text="index+1"
																					></a>
																				</li>
																			</template>
																			<li
																					class="page-item disabled"
																					:class="{ 'd-none' : pageCount_soon() <= 4 || pageNumber_soon >= pageCount_soon() -4}"
																			>
																				<a class="page-link">···</a>
																			</li>
																			<li
																					class="page-item"
																					:class="{ 'disabled' : pageNumber_soon >= pageCount_soon() -1 }"
																			>
																				<a
																						class="page-link page-next"
																						type="button"
																						x-on:click="nextPage_soon();"
																						:disabled="pageNumber_soon >= pageCount_soon() -1"
																				>
																					<i class="fa fas fa-chevron-right"></i>
																				</a>
																			</li>
																		</ul>
																	</nav>
																</div>
															</div>
														</div>
													</div>
												</div>
<!--												</div>-->
											</div>

										</div>
<!--										在有效期限內-->
										<div class="tab-pane fade" id="pills-valid-nobd" role="tabpanel" aria-labelledby="pills-today-tab-nobd">
											<div class="col-md-12">
<!--												<div class="card">-->
												<div class="card-header">
													<div class="d-flex align-items-center">
														<h4 class="card-title"></h4>
													</div>
												</div>
												<div class="card-body">
													<div class="table-responsive">
														<div id="add-row_wrapper" class="dataTables_wrapper container-fluid dt-bootstrap4">
															<div class="row">
																<div class="col-sm-12 col-md-6">
																	<div id="select-product_filter" class="mb-3">
																		<input x-on:keydown.enter="validProductSearch()" id="validProductKeyword" type="search" class="form-control" placeholder="可搜尋食材名稱" aria-controls="add-row">
																	</div>
																	<div class="d-flex flex-column flex-md-row align-items-start mb-3">
																		<select class="form-select form-control me-2 mb-2 mb-md-0" x-model="validSelectedCategory" x-on:change="validCategoryChange()">
																			<option value="">請選擇主分類</option>
																			<option value="MEAT">肉品</option>
																			<option value="SEAFOOD">海鮮</option>
																			<option value="VEGETABLES">青菜</option>
																			<option value="FRUITS">水果</option>
																			<option value="GRAINS">穀物</option>
																			<option value="BEVERAGES">飲料</option>
																			<option value="CONDIMENTS">醬料</option>
																			<option value="SNACKS">零食</option>
																			<option value="BAKERY">烘焙食品</option>
																			<option value="MEDICINE">藥品</option>
																			<option value="CANNED_FOOD">罐頭食品</option>
																			<option value="SPICES">香料</option>
																			<option value="OILS">食用油</option>
																			<option value="SWEETS">甜品</option>
																			<option value="DRIED_FOOD">乾貨</option>
																			<option value="HEALTH_FOOD">保健食品</option>
																		</select>
																		<template x-if="validSelectedCategory !== 'MEAT' && validSelectedCategory !== 'SEAFOOD'">
																			<select class="form-select form-control" x-model="validSelectedSubCategory" disabled x-on:change="validProductSearch()">
																				<option value="">-</option>
																			</select>
																		</template>
																		<template x-if="validSelectedCategory === 'MEAT'">
																			<select class="form-select form-control" x-model="validSelectedSubCategory" x-on:change="validProductSearch()">
																				<option value="">請選擇副分類</option>
																				<option value="BEEF">牛肉</option>
																				<option value="PORK">豬肉</option>
																				<option value="CHICKEN">雞肉</option>
																				<option value="EGG">雞蛋</option>
																			</select>
																		</template>
																		<template x-if="validSelectedCategory === 'SEAFOOD'">
																			<select class="form-select form-control" x-model="validSelectedSubCategory" x-on:change="validProductSearch()">
																				<option value="">請選擇副分類</option>
																				<option value="FISH">魚</option>
																				<option value="SHRIMP">蝦</option>
																			</select>
																		</template>
																	</div>
																	<div class="d-flex flex-column flex-md-row align-items-start">
																		<select class="form-select form-control" x-model="validStorePlace" x-on:change="validProductSearch()">
																			<option value="">請選擇存放位置</option>
																			<option value="HUALIEN_ALL">花蓮全部</option>
																			<option value="HUALIEN_REF_2F_LEFT">花蓮2樓左側冰箱</option>
																			<option value="HUALIEN_REF_2F_RIGHT">花蓮2樓右側冰箱</option>
																			<option value="HUALIEN_REF_1F_RIGHT">花蓮1樓冰箱</option>
																			<option value="HUALIEN_OTHER">花蓮其他</option>
																			<option value="TAIPEI_REF">台北冰箱</option>
																			<option value="TAIPEI_OTHER">台北其他</option>
																		</select>
																	</div>
																</div>
																<div class="col-sm-12 col-md-6 d-flex flex-column align-items-end mt-md-0 mt-2">
																	<div class="mb-3">
																		<button type="button" class="btn btn-primary" x-on:click="exportExcel('valid')">
																			<i class="fas fa-file-excel me-2"></i>
																			匯出Excel
																		</button>
																	</div>

																	<div class="d-flex flex-column align-items-end">
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-edit fs-5"></i>
																			<span class="ms-2 text-muted">：登錄使用數量</span>
																		</div>
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-map-marker fs-5"></i>
																			<span class="ms-2 text-muted">：變更存放位置</span>
																		</div>
																		<div class="d-flex align-items-center mb-2">
																			<i class="fas fa-list fs-5"></i>
																			<span class="ms-2 text-muted">：查看食材細節</span>
																		</div>
																		<div class="d-flex align-items-center">
																			<i class="fas fa-trash-alt fs-5"></i>
																			<span class="ms-2 text-muted">：丟棄庫存食材</span>
																		</div>
																	</div>
																</div>
															</div>
															<div class="row">
																<div class="col-sm-12">
																	<table id="add-row" class="display table table-striped table-hover dataTable" role="grid" aria-describedby="add-row_info">
																		<thead>
																		<tr role="row">
																			<th>食材照片</th>
																			<th>食材名稱</th>
																			<th>剩餘數量</th>
																			<th>有效期限</th>
																			<th>再過多久過期</th>
																			<th>已存放多久</th>
																			<th>何時通知快過期</th>
																			<th>動作</th>
																		</tr>
																		</thead>
																		<tbody>
																		<template x-for="(item,index) in getValidData()" :key="index">
																			<tr role="row" class="odd">
																				<td>
																					<img :src="item.coverPath" style="width: 100px; height: 100px; border-radius: 10%;">
																				</td>
																				<td x-text="item.name"></td>
																				<td x-text="item.totalAmount"></td>
																				<td x-text="item.expiryDate"></td>
																				<td x-text="item.expiryTime === '0天' ? '今天到期' : item.expiryTime"></td>
																				<td x-text="item.existedTime === '0天' ? '今天放進冰箱' : item.existedTime"></td>
																				<td x-text="item.noticeDate"></td>
																				<td>
																					<button @click="openAmountModal(item.receiveItemId, item.totalAmount)" type="button" data-bs-toggle="tooltip" title="登錄使用數量" class="btn btn-link btn-primary">
																						<i class="fas fa-edit fs-4"></i>
																					</button>
																					<button @click="openPlaceModal(item.receiveItemId, item.storePlaceLabel)" type="button" data-bs-toggle="tooltip" title="變更存放位置" class="btn btn-link btn-primary">
																						<i class="fas fa-map-marker fs-4"></i>
																					</button>
																					<button @click="openDetailModal(item.id)" type="button" data-bs-toggle="tooltip" title="查看庫存食材細節" class="btn btn-link btn-info">
																						<i class="fas fa-list fs-4"></i>
																					</button>
																					<button @click="openDeleteModal(item.receiveItemId)" type="button" data-bs-toggle="tooltip" title="丟棄" class="btn btn-link btn-danger">
																						<i class="fas fa-trash-alt fs-4"></i>
																					</button>
																				</td>
																			</tr>
																		</template>
																		</tbody>
																	</table>
																	<nav class="mt-5 mb-4" x-show="pageCount_valid() > 1">
																		<ul class="pagination justify-content-center card-page">
																			<li class="page-item" :class="{ 'disabled' : pageNumber_valid==0 }">
																				<a
																						class="page-link page-prev"
																						type="button"
																						x-on:click="prevPage_valid();"
																						:disabled="pageNumber_valid==0"
																				>
																					<i class="fa fas fa-chevron-left"></i>
																				</a>
																			</li>
																			<li
																					class="page-item disabled"
																					:class="{ 'd-none' : pageCount_valid() <= 4 || pageNumber_valid == 0 || ( pageCount_valid() > 4 && pageNumber_valid == pageCount_valid() ) }"
																			>
																				<a class="page-link">···</a>
																			</li>
																			<template x-for="(page,index) in pages_valid()" :key="index">
																				<li
																						class="page-item"
																						:class="{ 'active' : index === pageNumber_valid , 'd-none' : pageCount_valid() > 4 && ( (index < pageNumber_valid && pageNumber_valid < pageCount_valid() -4) || (index < pageCount_valid() -4 && pageNumber_valid >= pageCount_valid() -4) || index >= pageNumber_valid+4 ) }"
																				>
																					<a
																							class="page-link"
																							type="button"
																							x-on:click="viewPage_valid(index);"
																							x-text="index+1"
																					></a>
																				</li>
																			</template>
																			<li
																					class="page-item disabled"
																					:class="{ 'd-none' : pageCount_valid() <= 4 || pageNumber_valid >= pageCount_valid() -4}"
																			>
																				<a class="page-link">···</a>
																			</li>
																			<li
																					class="page-item"
																					:class="{ 'disabled' : pageNumber_valid >= pageCount_valid() -1 }"
																			>
																				<a
																						class="page-link page-next"
																						type="button"
																						x-on:click="nextPage_valid();"
																						:disabled="pageNumber_valid >= pageCount_valid() -1"
																				>
																					<i class="fa fas fa-chevron-right"></i>
																				</a>
																			</li>
																		</ul>
																	</nav>
																</div>
															</div>
														</div>
													</div>
												</div>
<!--												</div>-->
											</div>

										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<footer class="footer">
				<div class="container-fluid d-flex justify-content-between">
					<nav class="pull-left">
						<ul class="nav">
							<li class="nav-item">
								<a class="nav-link" href="http://www.themekita.com">
									ThemeKita
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="#"> Help </a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="#"> Licenses </a>
							</li>
						</ul>
					</nav>
					<div class="copyright">
						2024, made with <i class="fa fa-heart heart text-danger"></i> by
						<a href="http://www.themekita.com">ThemeKita</a>
					</div>
					<div>
						Distributed by
						<a target="_blank" href="https://themewagon.com/">ThemeWagon</a>.
					</div>
				</div>
			</footer>
		</div>

	</div>


	<!-- inventoryDetailModal -->
	<div class="modal fade" id="inventoryDetailModal" tabindex="-1" aria-hidden="true" style="display: none;">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header border-0">
					<h5 class="modal-title">
						<span class="fw-mediumbold" x-text="inventoryDetail.name"></span>
					</h5>
					<button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="table-responsive">
						<div class="dataTables_wrapper container-fluid dt-bootstrap4">
							<div class="row">
								<div class="col-12">
									<ul id="dataList" class="list-group" style="list-style-type: none; padding-left: 0;">
										<li class="d-flex align-items-center fs-5 mb-2">
											<i class="fas fa-kiwi-bird me-2"></i>
											包裝類型：<span x-text="inventoryDetail.packageFormLabel"></span>
										</li>
										<template x-if="inventoryDetail.packageForm == 'COMPLETE'">
											<li class="d-flex align-items-center fs-5 mb-2">
												<i class="fas fa-kiwi-bird me-2"></i>
												包裝方式：每<span x-text="inventoryDetail.packageUnitLabel"></span>有 <span x-text="inventoryDetail.packageQuantity"></span> 份
											</li>
										</template>
										<li class="d-flex align-items-center fs-5 mb-2">
											<i class="fas fa-kiwi-bird me-2"></i>
											食材分類：
											<span x-text="inventoryDetail.mainCategoryLabel"></span>
											<template x-if="inventoryDetail.subCategory">
												<span> (<span x-text="inventoryDetail.subCategoryLabel"></span>)</span>
											</template>
										</li>
										<li class="d-flex align-items-center fs-5 mb-2">
											<i class="fas fa-kiwi-bird me-2"></i>
											放進冰箱者：
											<template x-if="inventoryDetail.creator">
												<span x-text="inventoryDetail.creator"></span>
											</template>
											<template x-if="!inventoryDetail.creator">
												<i class="fas fa-minus-circle text-danger me-2"></i>
											</template>
										</li>
										<li class="d-flex align-items-center fs-5 mb-2">
											<i class="fas fa-kiwi-bird me-2"></i>
											存放位置：
											<template x-if="inventoryDetail.storePlace">
												<span x-text="inventoryDetail.storePlaceLabel"></span>
											</template>
											<template x-if="!inventoryDetail.storePlace">
												<i class="fas fa-minus-circle text-danger me-2"></i>
											</template>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer border-0">
					<button type="button" class="btn btn-danger" data-bs-dismiss="modal">
						關閉
					</button>
				</div>
			</div>
		</div>
	</div>



	<!--   Core JS Files   -->
	<script src="js/jquery-3.7.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<!-- jQuery Scrollbar -->
	<script src="js/jquery.scrollbar.min.js"></script>
	<!-- Moment JS -->
	<script src="js/moment.min.js"></script>
	<!-- Chart JS -->
	<script src="js/chart.min.js"></script>
	<!-- jQuery Sparkline -->
	<script src="js/jquery.sparkline.min.js"></script>
	<!-- Chart Circle -->
	<script src="js/circles.min.js"></script>
	<!-- Datatables -->
	<script src="js/datatables.min.js"></script>
	<!-- Bootstrap Notify -->
	<script src="js/bootstrap-notify.min.js"></script>
	<!-- jQuery Vector Maps -->
	<script src="js/jsvectormap.min.js"></script>
	<script src="js/world.js"></script>
	<!-- Sweet Alert -->
	<script src="js/sweetalert.min.js"></script>
	<!-- Kaiadmin JS -->
	<script src="js/kaiadmin.min.js"></script>
	<script src="js/alpine.2.8.2.min.js"></script>
	<script>
		function loadData() {
			return {
				pageNumber_today: 0,
				size_today: 10,
				total_today: "",
				pageNumber_soon: 0,
				size_soon: 10,
				total_soon: "",
				pageNumber_valid: 0,
				size_valid: 10,
				total_valid: "",
				todayList: [],
				todayListLabel: [],
				expiringSoonList: [],
				validList: [],
				todaySelectedCategory: "",
				todaySelectedSubCategory: "",
				soonSelectedCategory: "",
				soonSelectedSubCategory: "",
				validSelectedCategory: "",
				validSelectedSubCategory: "",
				todayStorePlace: "",
				soonStorePlace: "",
				validStorePlace: "",
				targetDeleteId: "",
				targetEditId: "",
				inventoryDetail: {},	//放庫存食材細節資訊，開啟modal時呈現

				init(){
					let _this = this;
				    $.ajax({
						url: "dashboard",
						type: "get",
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								console.log(response.data)
								const { today, expiringSoon, valid } = response.data;

								_this.todayList = today.map(item => ({
									...item,
								}))
								_this.expiringSoonList = expiringSoon.map(item => ({
									...item,
								}))
								_this.validList = valid.map(item => ({
									...item,
								}))
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});

				    $.ajax({
						url: "getTodaySize",
						type: "get",
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								_this.todayListLabel = response.data;
							}
						},
				  	});
				},
				getTodayData() {
					this.todayList.forEach(item => {
						if (item.coverPath.endsWith('/null')) {
							item.coverPath = 'images/fridge002.jpg';
						}
					});
					const start = this.pageNumber_today * this.size_today;
					const end = start + this.size_today;
					this.total_today = this.todayList.length;
					return this.todayList.slice(start, end);
				},
				getExpiringSoonData(){
					this.expiringSoonList.forEach(item => {
						if (item.coverPath.endsWith('/null')) {
							item.coverPath = 'images/fridge002.jpg';
						}
					});
					const start = this.pageNumber_soon * this.size_soon;
					const end = start + this.size_soon;
					this.total_soon = this.expiringSoonList.length;
					return this.expiringSoonList.slice(start, end);
				},
				getValidData(){
					this.validList.forEach(item => {
						if (item.coverPath.endsWith('/null')) {
							item.coverPath = 'images/fridge002.jpg';
						}
					});
					const start = this.pageNumber_valid * this.size_valid;
					const end = start + this.size_valid;
					this.total_valid = this.validList.length;
					return this.validList.slice(start, end);
				},
				todayCategoryChange() {
					this.todaySelectedSubCategory = '';
					this.todayProductSearch();
				},
				soonCategoryChange() {
					this.soonSelectedSubCategory = '';
					this.soonProductSearch();
				},
				validCategoryChange() {
					this.validSelectedSubCategory = '';
					this.validProductSearch();
				},
				todayProductSearch(){
					let _this = this;
					let data = {};
					data.keyword = $("#todayProductKeyword").val();
					data.mainCategory = this.todaySelectedCategory;
					data.subCategory = this.todaySelectedSubCategory;
					data.storePlace = this.todayStorePlace;
					data.type = "today";

				    $.ajax({
						url: "inventorySearch",
						type: "post",
						data: JSON.stringify(data),
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								_this.todayList = response.data;
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});
				},
				soonProductSearch(){
					let _this = this;
					let data = {};
					data.keyword = $("#soonProductKeyword").val();
					data.mainCategory = this.soonSelectedCategory;
					data.subCategory = this.soonSelectedSubCategory;
					data.storePlace = this.soonStorePlace;
					data.type = "soon";

				    $.ajax({
						url: "inventorySearch",
						type: "post",
						data: JSON.stringify(data),
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								_this.expiringSoonList = response.data;
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});
				},
				validProductSearch(){
					let _this = this;
					let data = {};
					data.keyword = $("#validProductKeyword").val();
					data.mainCategory = this.validSelectedCategory;
					data.subCategory = this.validSelectedSubCategory;
					data.storePlace = this.validStorePlace;
					data.type = "valid";

				    $.ajax({
						url: "inventorySearch",
						type: "post",
						data: JSON.stringify(data),
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								_this.validList = response.data;
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});
				},
				openDeleteModal(receiveItemId){
					let _this = this;
					Swal.fire({
						title: '確認要刪除？',
						text: '點擊確認後食材將從冰箱中消失',
						icon: 'warning',
						showCancelButton: true,
						confirmButtonText: '確認',
						cancelButtonText: '取消',
						customClass: {
							confirmButton: 'btn btn-success',
							cancelButton: 'btn btn-danger'
						}
					}).then((result) => {
						if (result.isConfirmed) {
							_this.targetDeleteId = receiveItemId;
							_this.deleteInventory();
						}
					});
				},
				openAmountModal(receiveItemId, amount){
					let _this = this;
					Swal.fire({
						title: '填寫使用的數量',
						text: '剩餘數量：' + amount,
						input: 'number',
						inputAttributes: {
							min: 1,          // 最小值
							max: amount,     // 最大值等於剩餘數量
							step: 1
						},
						showCancelButton: true,
						confirmButtonText: '確認',
						cancelButtonText: '取消',
						customClass: {
							confirmButton: 'btn btn-success',
							cancelButton: 'btn btn-danger'
						}
					}).then((result) => {
						if (result.isConfirmed) {
							let enteredAmount = result.value;
							_this.targetEditId = receiveItemId;
							_this.editAmountInventory(enteredAmount);
						}
					});
				},
				openDetailModal(inventoryId){
					let _this = this;
				    $.ajax({
						url: "getInventoryInfo/" + inventoryId,
						type: "get",
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								_this.inventoryDetail = response.data;
								$("#inventoryDetailModal").modal('show');
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});
				},
				deleteInventory(){
					let _this = this;
				    $.ajax({
						url: "deleteInventory/" + this.targetDeleteId,
						type: "get",
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								Swal.fire({
									title: '刪除成功！',
									text: '',
									icon: 'success',
									confirmButtonText: '關閉',
									customClass: {
										confirmButton: 'btn btn-success'
									}
								}).then((result) => {
									if (result.isConfirmed) {
										_this.init();
									}
								});
							} else {
								Swal.fire({
									title: '錯誤發生，請聯繫管理員！',
									text: '',
									icon: 'error',
									confirmButtonText: '關閉',
									customClass: {
										confirmButton: 'btn btn-danger'
									}
								})
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});
				},
				openPlaceModal(receiveItemId, storePlace) {
					let _this = this;
					Swal.fire({
						title: '變更存放位置',
						text: '目前存放在：' + storePlace,
						input: 'select',
						inputOptions: {
							'': '請選擇',
							'HUALIEN_REF_2F_LEFT': '花蓮2樓左側冰箱',
							'HUALIEN_REF_2F_RIGHT': '花蓮2樓右側冰箱',
							'HUALIEN_REF_1F_RIGHT': '花蓮1樓冰箱',
							'HUALIEN_OTHER': '花蓮其他',
							'TAIPEI_REF': '台北冰箱',
							'TAIPEI_OTHER': '台北其他'
						},
						showCancelButton: true,
						confirmButtonText: '確認',
						cancelButtonText: '取消',
						customClass: {
							confirmButton: 'btn btn-success',
							cancelButton: 'btn btn-danger'
						},
						preConfirm: (value) => {
							if (value === '') {  // 如果沒選擇
								Swal.showValidationMessage('尚未選擇存放位置');  // 顯示錯誤訊息
								return false;  // 阻止確認提交
							}
							return value;  // 返回選擇的值
						}
					}).then((result) => {
						if (result.isConfirmed) {
							let choseStorePlace = result.value; // 選擇的存放位置
							_this.targetEditId = receiveItemId;
							_this.editStorePlaceInventory(choseStorePlace);
						}
					});
				},
				editAmountInventory(enteredAmount){
					let _this = this;
					let data = {};
					data.receiveItemId = this.targetEditId;
					data.usedAmount = enteredAmount;
				    $.ajax({
						url: "editAmountInventory",
						type: "post",
						data: JSON.stringify(data),
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								Swal.fire({
									title: '編輯成功！',
									text: '請至清單頁查看剩餘數量是否正確',
									icon: 'success',
									confirmButtonText: '關閉',
									customClass: {
										confirmButton: 'btn btn-success'
									}
								}).then((result) => {
									if (result.isConfirmed) {
										_this.init();
									}
								});
							} else {
								Swal.fire({
									title: '錯誤發生，請聯繫管理員！',
									text: '',
									icon: 'error',
									confirmButtonText: '關閉',
									customClass: {
										confirmButton: 'btn btn-danger'
									}
								})
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});
				},
				editStorePlaceInventory(choseStorePlace){
					let _this = this;
					let data = {};
					data.receiveItemId = this.targetEditId;
					data.newStorePlace = choseStorePlace;
				    $.ajax({
						url: "editStorePlaceInventory",
						type: "post",
						data: JSON.stringify(data),
						contentType: "application/json; charset=utf-8",
						success: function (response) {
							if (response.code == "C000"){
								Swal.fire({
									title: '變更成功！',
									text: '請至清單頁查看新存放位置是否正確',
									icon: 'success',
									confirmButtonText: '關閉',
									customClass: {
										confirmButton: 'btn btn-success'
									}
								}).then((result) => {
									if (result.isConfirmed) {
										_this.init();
									}
								});
							} else {
								Swal.fire({
									title: '錯誤發生，請聯繫管理員！',
									text: '',
									icon: 'error',
									confirmButtonText: '關閉',
									customClass: {
										confirmButton: 'btn btn-danger'
									}
								})
							}
						},
						error: function(error) {
							Swal.fire({
								title: '系統錯誤，請聯繫管理員！',
								text: '',
								icon: 'error',
								confirmButtonText: '關閉',
								customClass: {
									confirmButton: 'btn btn-danger'
								}
							})
							console.error('Error:', error);
						}
				  	});
				},
				exportExcel(type){
					let _this = this;
					let data = [];
					if (type == 'today'){
						type = '今日放進冰箱';
						data = this.todayList
					} else if (type == 'soon'){
						type = '快過期的';
						data = this.expiringSoonList;
					} else if (type == 'valid'){
						type = '在有效期限內';
						data = this.validList;
					}

					if (data.length == 0){
						Swal.fire({
							title: '無資料匯出！',
							text: '',
							icon: 'info',
							confirmButtonText: '關閉',
							customClass: {
								confirmButton: 'btn btn-secondary'
							}
						});
						return;
					}

					fetch("exportExcel/" + type, {
						method: "POST",
						body: JSON.stringify(data),
						headers: {
							"Content-Type": "application/json; charset=utf-8"
						}
					})
					.then(response => response.blob())
					.then(blob => {
						const url = window.URL.createObjectURL(blob);
						const a = document.createElement('a');
						a.href = url;
						a.download = "食材庫存清單.xlsx";
						document.body.appendChild(a);
						a.click();
						a.remove();
						window.URL.revokeObjectURL(url);
					})
					.catch(error => {
						Swal.fire({
							title: '系統錯誤，請聯繫管理員！',
							text: '',
							icon: 'error',
							confirmButtonText: '關閉',
							customClass: {
								confirmButton: 'btn btn-danger'
							}
						});
						console.error('Error:', error);
					});
				},
				pages_today() {
					return Array.from({
						length: Math.ceil(this.total_today / this.size_today),
					});
				},
				nextPage_today() { this.pageNumber_today++;},
				prevPage_today() { this.pageNumber_today--;},
				pageCount_today() { return Math.ceil(this.total_today / this.size_today);},
				viewPage_today(index) { this.pageNumber_today = index;},
				pages_soon() {
					return Array.from({
						length: Math.ceil(this.total_soon / this.size_soon),
					});
				},
				nextPage_soon() { this.pageNumber_soon++;},
				prevPage_soon() { this.pageNumber_soon--;},
				pageCount_soon() { return Math.ceil(this.total_soon / this.size_soon);},
				viewPage_soon(index) { this.pageNumber_soon = index;},
				pages_valid() {
					return Array.from({
						length: Math.ceil(this.total_valid / this.size_valid),
					});
				},
				nextPage_valid() { this.pageNumber_valid++;},
				prevPage_valid() { this.pageNumber_valid--;},
				pageCount_valid() { return Math.ceil(this.total_valid / this.size_valid);},
				viewPage_valid(index) { this.pageNumber_valid = index;},
			};
		}
	</script>
</body>
</html>